include $(TOP)/config/make.cfg

%define_libs

CFLAGS	:= $(USER_DEFINES) -O2 -Wunused -Wall $(SPECIAL_CFLAGS) $(INCLUDES)
OBJDIR	:= $(GENDIR)/$(CURDIR)
DESTDIR := $(BINDIR)

UNFILES := \
	BitmapClass \
	DOSIconClass \
	DOSListIconClass \
	GroupClass \
	IconClass \
	MainTask \
	MenuItemClass \
	MethodSenderClass \
	PPCRootClass \
	PPCThreadRootClass \
	PopupMenuClass \
	ScreenClass \
	TextClass \
	scalosmaster.library


FILES := \
        AmigaIconClass \
	AreaClass \
	Chunky8TestClass \
	DOSDeviceIconClass \
	DOSDirIconClass \
	DOSFileIconClass \
	DebugPPC \
	GFXTestClass \
	GraphicClass \
	IconPanelClass \
	NodeListClass \
	PanelClass \
	PanelViewClass \
	PlanarTestClass \
	RectFillClass \
	RootClass \
	SubRoutines \
	TableClass \
	ThreadRootClass \
	WindowClass \
	WindowTaskClass \

SRCS := $(foreach f, $(FILES), $(f).c)
OBJS := $(foreach f, $(FILES), $(OBJDIR)/$(f).o)

EXE := $(DESTDIR)/Scalos

.PHONY : all clean

#MM scalos : setup-scalos
scalos : $(OBJS) $(EXE)
	@$(NOP)

#MM setup-scalos : includes-scalos
setup-scalos :
	%mkdirs_q $(DESTDIR) $(OBJDIR)

$(EXE) : $(DESTDIR)/% : $(OBJS) $(DEPLIBS)
	@$(ECHO) "Linking $@..."
	@$(CC) $(ILDFLAGS) $(STARTUP) $(OBJS) -o $@ $(LIBS)
	@$(ECHO) "Checking $@..."
	@$(CHECKUDS) $@

#MM
clean-scalos :
	@$(RM) $(OBJDIR) $(DESTDIR)

$(OBJDIR)/%.o : %.c
	%compile_q

