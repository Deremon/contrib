VERSION             = 40
MODNAME             = Scalos

COMPILER_OPTS_DEBUG = NOLINK MATH=68882 NOMODIFIED ERRORREXX STRUCTUREEQUIVALENCE NOSTACKCHECK DEBUG=FULLFLUSH DEFINE=DEBUG_SERIAL DEFINE=NOLOCKLAYER
COMPILER_OPTS       = NOLINK MATH=68882 NOMODIFIED ERRORREXX STRUCTUREEQUIVALENCE NOSTACKCHECK 

LINKER_OPTS_DEBUG   = SC SD ADDSYM
LINKER_OPTS         = SC SD ND

OBJECTS_DEBUG       = SubRoutines.oDEBUG ScreenClass.oDEBUG WindowClass.oDEBUG MainTask.oDEBUG RootClass.oDEBUG AreaClass.oDEBUG WindowTaskClass.oDEBUG RectFillClass.oDEBUG BitmapClass.oDEBUG PlanarTestClass.oDEBUG Chunky8TestClass.oDEBUG ThreadRootClass.oDEBUG MethodSenderClass.oDEBUG GroupClass.oDEBUG scalosmaster.library.oDEBUG PanelClass.oDEBUG IconPanelClass.oDEBUG PanelViewClass.oDEBUG
OBJECTS             = SubRoutines.o      ScreenClass.o      WindowClass.o      MainTask.o      RootClass.o      AreaClass.o      WindowTaskClass.o      RectFillClass.o      BitmapClass.o      PlanarTestClass.o      Chunky8TestClass.o      ThreadRootClass.o      MethodSenderClass.o      GroupClass.o      scalosmaster.library.o      PanelClass.o      IconPanelClass.o      PanelViewClass.o

STARTUP             = LIB:c.o

LIBS_DEBUG          = LIB:sc.lib LIB:amiga.lib LIB:scm881.lib LIB:debug.lib
LIBS                = LIB:sc.lib LIB:amiga.lib LIB:scm881.lib

LINKER              = slink
COMPILER            = sc
ASSEMBLER           = asm

all: $(MODNAME)_debug

$(MODNAME)_debug: $(OBJECTS_DEBUG) $(LIBS)
  $(LINKER) <with <
FROM $(STARTUP) $(OBJECTS_DEBUG) TO $(MODNAME)_debug LIB $(LIBS_DEBUG) $(LINKER_OPTS_DEBUG)
<

$(MODNAME): $(OBJECTS) $(LIBS)
  $(LINKER) <with <
FROM $(STARTUP) $(OBJECTS) TO $(MODNAME) LIB $(LIBS) $(LINKER_OPTS)
<

# Default rules...
.c.o:
    $(COMPILER) $(COMPILER_OPTS) $*.c

.c.oDEBUG:
    $(COMPILER) $(COMPILER_OPTS_DEBUG) ObjectName=$*.oDEBUG $*.c

.asm.o:
    $(ASSEMBLER) $(ASSEMBLER_OPTS) $*.asm $*.o

# Dependencies
SubRoutines.o          : SubRoutines.c smakefile Debug.h MethodSenderClass.h
SubRoutines.oDEBUG     : SubRoutines.c smakefile Debug.h MethodSenderClass.h

ScreenClass.o          : ScreenClass.c ScreenClass.h Scalos.h ScalosIntern.h smakefile Debug.h
ScreenClass.oDEBUG     : ScreenClass.c ScreenClass.h Scalos.h ScalosIntern.h smakefile Debug.h

WindowClass.o          : WindowClass.c WindowClass.h Scalos.h ScalosIntern.h smakefile Debug.h
WindowClass.oDEBUG     : WindowClass.c WindowClass.h Scalos.h ScalosIntern.h smakefile Debug.h

AreaClass.o            : AreaClass.c AreaClass.h Scalos.h ScalosIntern.h smakefile Debug.h
AreaClass.oDEBUG       : AreaClass.c AreaClass.h Scalos.h ScalosIntern.h smakefile Debug.h

RootClass.o            : RootClass.c RootClass.h Scalos.h ScalosIntern.h smakefile Debug.h
RootClass.oDEBUG       : RootClass.c RootClass.h Scalos.h ScalosIntern.h smakefile Debug.h

WindowTaskClass.o      : WindowTaskClass.c WindowTaskClass.h Scalos.h ScalosIntern.h smakefile Debug.h
WindowTaskClass.oDEBUG : WindowTaskClass.c WindowTaskClass.h Scalos.h ScalosIntern.h smakefile Debug.h

RectFillClass.o        : RectFillClass.c RectFillClass.h Scalos.h ScalosIntern.h smakefile Debug.h
RectFillClass.oDEBUG   : RectFillClass.c RectFillClass.h Scalos.h ScalosIntern.h smakefile Debug.h

BitmapClass.o          : BitmapClass.c BitmapClass.h Scalos.h ScalosIntern.h smakefile Debug.h
BitmapClass.oDEBUG     : BitmapClass.c BitmapClass.h Scalos.h ScalosIntern.h smakefile Debug.h

MainTask.o             : MainTask.c MainTask.h ScalosIntern.h Scalos.h WindowClass.h ScreenClass.h AreaClass.h WindowTaskClass.h RootClass.h RectFillClass.h smakefile Debug.h MethodSenderClass.h
MainTask.oDEBUG        : MainTask.c MainTask.h ScalosIntern.h Scalos.h WindowClass.h ScreenClass.h AreaClass.h WindowTaskClass.h RootClass.h RectFillClass.h smakefile Debug.h MethodSenderClass.h

PlanarTestClass.o      : PlanarTestClass.c PlanarTestClass.h Scalos.h ScalosIntern.h smakefile Debug.h
PlanarTestClass.oDEBUG : PlanarTestClass.c PlanarTestClass.h Scalos.h ScalosIntern.h smakefile Debug.h

Chunky8TestClass.o      : Chunky8TestClass.c Chunky8TestClass.h Scalos.h ScalosIntern.h smakefile Debug.h
Chunky8TestClass.oDEBUG : Chunky8TestClass.c Chunky8TestClass.h Scalos.h ScalosIntern.h smakefile Debug.h

ThreadRootClass.o      : ThreadRootClass.c RootClass.h Scalos.h ScalosIntern.h smakefile Debug.h MethodSenderClass.h
ThreadRootClass.oDEBUG : ThreadRootClass.c RootClass.h Scalos.h ScalosIntern.h smakefile Debug.h MethodSenderClass.h

MethodSenderClass.o      : MethodSenderClass.c MethodSenderClass.h Scalos.h ScalosIntern.h smakefile Debug.h
MethodSenderClass.oDEBUG : MethodSenderClass.c MethodSenderClass.h Scalos.h ScalosIntern.h smakefile Debug.h

GroupClass.o           : GroupClass.c GroupClass.h Scalos.h ScalosIntern.h smakefile Debug.h
GroupClass.oDEBUG      : GroupClass.c GroupClass.h Scalos.h ScalosIntern.h smakefile Debug.h

scalosmaster.library.o      : scalosmaster.library.c Scalos.h ScalosIntern.h smakefile Debug.h
scalosmaster.library.oDEBUG : scalosmaster.library.c Scalos.h ScalosIntern.h smakefile Debug.h

PanelClass.o           : PanelClass.c PanelClass.h Scalos.h ScalosIntern.h smakefile Debug.h
PanelClass.oDEBUG      : PanelClass.c PanelClass.h Scalos.h ScalosIntern.h smakefile Debug.h

IconPanelClass.o       : IconPanelClass.c IconPanelClass.h Scalos.h ScalosIntern.h smakefile Debug.h
IconPanelClass.oDEBUG  : IconPanelClass.c IconPanelClass.h Scalos.h ScalosIntern.h smakefile Debug.h

PanelViewClass.o       : PanelViewClass.c PanelViewClass.h Scalos.h ScalosIntern.h smakefile Debug.h
PanelViewClass.oDEBUG  : PanelViewClass.c PanelViewClass.h Scalos.h ScalosIntern.h smakefile Debug.h


# Update revision
version:
    -bumprev $(VERSION) $(MODNAME)_rev

# Delete stuff
clean:
    -Delete $(OBJECTS)
	-Delete $(OBJECTS_DEBUG)
	-Delete $(MODNAME) $(MODNAME)_debug $(MODNAME)_*_src.lha $(MODNAME)_*_rel.lha

packsrc:
    -Execute < <
    set REVISION `type Scalos_rev.rev`
    delete $(MODNAME)_*_src.lha
    lha a $(MODNAME)_$(VERSION).$$REVISION_src.lha ~((*.(s|o|oDEBUG|info))|$(MODNAME)|$(MODNAME)_debug|$(MODNAME)_$(VERSION).$$REVISION_rel.lha|temp_smk.tmp)
    <

packrel:
    -Execute < <
    set REVISION `type Scalos_rev.rev`
    delete $(MODNAME)_*_rel.lha
    lha a $(MODNAME)_$(VERSION).$$REVISION_rel.lha $(MODNAME)
    <
