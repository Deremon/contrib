diff -ur -x .svn /data/deadwood/source/drm-2.4.17/nouveau/nouveau_bo.c libdrm/nouveau/nouveau_bo.c
--- /data/deadwood/source/drm-2.4.17/nouveau/nouveau_bo.c	2009-12-20 21:03:30.000000000 +0100
+++ libdrm/nouveau/nouveau_bo.c	2009-12-23 12:52:04.000000000 +0100
@@ -28,7 +28,9 @@
 #include <errno.h>
 #include <assert.h>
 
+#if !defined(__AROS__)
 #include <sys/mman.h>
+#endif
 
 #include "nouveau_private.h"
 
@@ -99,7 +101,11 @@
 		return;
 
 	if (nvbo->map) {
+#if !defined(__AROS__)        
 		munmap(nvbo->map, nvbo->size);
+#else
+        drmMUnmap(nvdev->fd, nvbo->handle);
+#endif
 		nvbo->map = NULL;
 	}
 
@@ -161,13 +167,18 @@
 	if (!nvbo->map_handle)
 		return -EINVAL;
 
+#if !defined(__AROS__)
 	nvbo->map = mmap(0, nvbo->size, PROT_READ | PROT_WRITE,
 			 MAP_SHARED, nvdev->fd, nvbo->map_handle);
 	if (nvbo->map == MAP_FAILED) {
 		nvbo->map = NULL;
 		return -errno;
 	}
-
+#else
+    nvbo->map = drmMMap(nvdev->fd, nvbo->handle);
+    if (nvbo->map == NULL)
+        return -EINVAL;
+#endif
 	return 0;
 }
 
diff -ur -x .svn /data/deadwood/source/drm-2.4.17/nouveau/nouveau_channel.c libdrm/nouveau/nouveau_channel.c
--- /data/deadwood/source/drm-2.4.17/nouveau/nouveau_channel.c	2009-12-20 21:03:30.000000000 +0100
+++ libdrm/nouveau/nouveau_channel.c	2009-12-23 12:46:56.000000000 +0100
@@ -111,6 +111,8 @@
 
 	FIRE_RING(&nvchan->base);
 
+	nouveau_pushbuf_fini(&nvchan->base);
+
 	nouveau_bo_unmap(nvchan->notifier_bo);
 	nouveau_bo_ref(NULL, &nvchan->notifier_bo);
 
diff -ur -x .svn /data/deadwood/source/drm-2.4.17/nouveau/nouveau_drmif.h libdrm/nouveau/nouveau_drmif.h
--- /data/deadwood/source/drm-2.4.17/nouveau/nouveau_drmif.h	2009-12-20 21:03:30.000000000 +0100
+++ libdrm/nouveau/nouveau_drmif.h	2009-12-23 12:46:56.000000000 +0100
@@ -24,7 +24,7 @@
 #define __NOUVEAU_DRMIF_H__
 
 #include <stdint.h>
-#include <xf86drm.h>
+#include <arosdrm.h>
 
 #include "nouveau_device.h"
 
diff -ur -x .svn /data/deadwood/source/drm-2.4.17/nouveau/nouveau_private.h libdrm/nouveau/nouveau_private.h
--- /data/deadwood/source/drm-2.4.17/nouveau/nouveau_private.h	2009-12-20 21:03:30.000000000 +0100
+++ libdrm/nouveau/nouveau_private.h	2009-12-23 12:46:56.000000000 +0100
@@ -24,7 +24,7 @@
 #define __NOUVEAU_PRIVATE_H__
 
 #include <stdint.h>
-#include <xf86drm.h>
+#include <arosdrm.h>
 #include <nouveau_drm.h>
 
 #include "nouveau_drmif.h"
@@ -65,6 +65,9 @@
 int
 nouveau_pushbuf_init(struct nouveau_channel *);
 
+void
+nouveau_pushbuf_fini(struct nouveau_channel *);
+
 struct nouveau_channel_priv {
 	struct nouveau_channel base;
 
diff -ur -x .svn /data/deadwood/source/drm-2.4.17/nouveau/nouveau_pushbuf.c libdrm/nouveau/nouveau_pushbuf.c
--- /data/deadwood/source/drm-2.4.17/nouveau/nouveau_pushbuf.c	2009-12-20 21:03:30.000000000 +0100
+++ libdrm/nouveau/nouveau_pushbuf.c	2009-12-23 12:46:56.000000000 +0100
@@ -170,6 +170,12 @@
 	return 0;
 }
 
+void
+nouveau_pushbuf_fini(struct nouveau_channel *chan)
+{
+	nouveau_pushbuf_fini_call(chan);
+}
+
 int
 nouveau_pushbuf_flush(struct nouveau_channel *chan, unsigned min)
 {
