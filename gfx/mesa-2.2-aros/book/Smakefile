# Makefile for book programs


# $Id$

##### MACROS #####

INCDIR = /include
GL_LIB = MesaGL.LIB
GLU_LIB = MesaGLU.LIB
TK_LIB = Mesatk.LIB
AUX_LIB = Mesaaux.LIB

TMP_FILE = T:MesaTMP_SCOPTS

# Only for AMIWIN
XLIBS = X11.LIB
XDIR = x11:sasc
NET_INCLUDE = netinclude:
NET_LIB = netinclude:/netlib/net.lib

AMIWINGL_LIBS = lib lib:sc.lib+lib:scm881.lib+lib:scmieee.lib+$(XDIR)/lib/$(XLIBS)+/lib/$(AUX_LIB)+/lib/$(TK_LIB)+/lib/$(GLU_LIB)+/lib/$(GL_LIB)

AMIGAGL_LIBS =  lib lib:sc.lib+/lib/$(AUX_LIB)+/lib/$(TK_LIB)+/lib/$(GLU_LIB)


# Removed accpersp and dof 
# since problem with near/far variables being confused with SAS/C internal data types.

#accanti
P1=  accnot accum aim alpha alpha3D \
	anti antiindex antipindex antipoint antipoly \
	bezcurve bezmesh bezsurf checker checker2 \
	chess clip colormat cone cube curve \
	depthcue disk dofnot double drawf \
	feedback fog fogindex font light linelist \
	lines list list2

P2= maplight material mipmap \
	model movelight nurbs pickdepth pickline \
	picksquare plane planet planetup polys \
	robot sccolorlight scene scenebamb sceneflat \
	select smooth sphere stencil stroke \
	surface tea teaambient teapots texgen texturesurf

PROGS = $(P1) $(P2) simple xfont

#Missing from amiga version:simple xfont
AMIGAPROGS = $(P1) $(P2)

CC = sc

AMIWINSCFLAGS = idir=$(INCDIR) idir=$(XDIR)/include data=far idlen=63 \
			 nostkchk IGN=ALL optimize math=68882 cpu=68040 define=AMIWIN

AMIGASCFLAGS = idir=$(INCDIR) data=far idlen=63 with=/amiga/SCOPTIONS\
			 IGN=ALL define=AMIGA


##### TARGETS ######

default: 
	@echo "specify: smake <target>"
	@echo "Where <targets> is one of"
	@echo "       amiga   - Compiles using link library"
	@echo "       library - Compiles using standard library (still beta)"
	@echo "       targets - Compilations for AMIWIN"
	smake amiga

clean:
	-delete *.o *.lnk *.info

realclean: 
	-delete $(P1)
	-delete $(P2)
	-delete xfont simple
	-delete *.o *.lnk *.info

amiga: AmigaLIB $(AMIGAPROGS) DeleteTMP

library: AmigaLibrary $(AMIGAPROGS) DeleteTMP

targets: AMIWIN $(PROGS) DeleteTMP


AmigaLIB:
	@echo >$(TMP_FILE) "$(AMIGASCFLAGS) define=AMIGALIB $(AMIGAGL_LIBS)+/lib/$(GL_LIB)"

AmigaLibrary:
	@echo >$(TMP_FILE) "$(AMIGASCFLAGS) $(AMIGAGL_LIBS)"

AMIWIN:
	@echo >$(TMP_FILE) "$(AMIWINSCFLAGS) $(AMIWINGL_LIBS)"

DeleteTMP:
	@delete $(TMP_FILE)

$(PROGS):
	$(CC) WITH=$(TMP_File) link $>.c
