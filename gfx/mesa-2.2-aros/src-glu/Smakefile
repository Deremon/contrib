# Makefile for GLU for Unix

# Mesa 3-D graphics library
# Version:  1.2.6
# Copyright (C) 1995  Brian Paul  (brianp@ssec.wisc.edu)
#
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Library General Public
# License as published by the Free Software Foundation; either
# version 2 of the License, or (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Library General Public License for more details.
#
# You should have received a copy of the GNU Library General Public
# License along with this library; if not, write to the Free
# Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.


# makefile for SAS/C AmiWin port by Victor Ng-Thow-Hing
# altered to also include Amiga port by StefanZ

##### MACROS #####

INCDIR = /include
LIBDIR = /lib

TMP_FILE = T:MesaTMP_SCOPTS

SOURCES = glu.c mipmap.c nurbs.c nurbscrv.c nurbssrf.c nurbsutl.c \
	project.c quadric.c tess.c tesselat.c polytest.c

OBJECTS = glu.o mipmap.o nurbs.o nurbscrv.o nurbssrf.o nurbsutl.o \
	project.o quadric.o tess.o tesselat.o polytest.o
CC = sc

AMIWINSCFLAGS = idir=$(INCDIR) idir=x11:sasc/include data=far idlen=63 \
          nostkchk IGN=ALL math=68882 cpu=68040 optimize define=AMIWIN

AMIGASCFLAGS = idir=$(INCDIR) data=far idlen=63 with=/amiga/SCOPTIONS\
          nolink IGN=ALL define=AMIGA param=both


MAKELIB = oml
GLU_LIB = MesaGLU.LIB
LIB_NAME = $(LIBDIR)/$(GLU_LIB)

##### RULES #####

.c.o:
	$(CC) WITH=$(TMP_File) $*.c


##### TARGETS #####
default:
	@echo "specify: smake <target>"
	@echo "Where <targets> is one of"
	@echo "       amiga   - Compiles a link library (LIB-file)"
	@echo "       library - Compiles a link library (LIB-file)"
	@echo "                 using the shared library (still beta)"
	@echo "       targets - Compilations for AMIWIN"

clean:
	-delete *.o $(GLU_LIB)

targets: AMIWINLIB

amiga: CreateAmigaLIB

library: AmigaLIBsh

# Make the library
CreateAmigaLIB: AmigaLIB $(OBJECTS) DeleteTMP
	$(MAKELIB) $(LIB_NAME) R $(OBJECTS)

AmigaLIBsh: AmigaLibrary $(OBJECTS) DeleteTMP
	$(MAKELIB) $(LIB_NAME) R $(OBJECTS)

AMIWINLIB: AMIWIN $(OBJECTS) DeleteTMP
	$(MAKELIB) $(LIB_NAME) R $(OBJECTS)

# Makes temporary scoptions to use in global .c.o	
AmigaLIB:
	@echo >$(TMP_FILE) "$(AMIGASCFLAGS) define=AMIGALIB"

AmigaLibrary:
	@echo >$(TMP_FILE) "$(LIBRARYSCFLAGS)"

AMIWIN:
	@echo >$(TMP_FILE) "$(AMIWINSCFLAGS)"

DeleteTMP:
	@delete $(TMP_FILE)

