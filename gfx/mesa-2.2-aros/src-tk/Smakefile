# Makefile for tk toolkit

# Mesa 3-D graphics library
# Version:  1.2.6
# Copyright (C) 1995  Brian Paul  (brianp@ssec.wisc.edu)
#
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Library General Public
# License as published by the Free Software Foundation; either
# version 2 of the License, or (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Library General Public License for more details.
#
# You should have received a copy of the GNU Library General Public
# License along with this library; if not, write to the Free
# Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.



# makefile for SAS/C AmiWin port by Victor Ng-Thow-Hing
# altered to also include Amiga port by StefanZ


##### MACROS #####

INCDIR = /include
LIBDIR = /lib
XDIR = x11:sasc

TMP_FILE = T:MesaTMP_SCOPTS


AMIGASOURCES = awindow.c font.c shapes.c image.c
AMIWINSOURCESS = cursor.c event.c font.c getset.c image.c shapes.c window.c

AMIGAOBJECTS = awindow.o font.o shapes.o image.o
AMIWINOBJECTS = cursor.o event.o font.o getset.o image.o shapes.o window.o

AMIGASCFLAGS = idir=$(INCDIR) data=far idlen=63 with=/amiga/SCOPTIONS\
          nolink IGN=ALL define=AMIGA 

AMIWINSCFLAGS = idir=$(INCDIR) idir=$(XDIR)/include data=far idlen=63 \
          nostkchk IGN=ALL math=68882 cpu=68040 optimize define=AMIWIN

CC = sc
MAKELIB = oml
TK_LIB = Mesatk.LIB
LIB_NAME = $(LIBDIR)/$(TK_LIB)


##### RULES #####

.c.o:
	$(CC) WITH=$(TMP_File) $*.c

##### TARGETS #####

default:
	@echo "specify: smake <target>"
	@echo "Where <targets> is one of"
	@echo "       amiga   - Compiles a link library (LIB-file)"
	@echo "       library - Compiles a link library (LIB-file)"
	@echo "                 using the shared library (still beta)"
	@echo "       targets - Compilations for AMIWIN"
	smake amiga

clean:
	-delete *.o

targets: AMIWINLIB

amiga: CreateAmigaLIB

library: AmigaLIBsh

# Make the library
CreateAmigaLIB: AmigaLIB $(AMIGAOBJECTS) DeleteTMP
	$(MAKELIB) $(LIB_NAME) R $(AMIGAOBJECTS)

AmigaLIBsh: AmigaLibrary $(AMIGAOBJECTS) DeleteTMP
	$(MAKELIB) $(LIB_NAME) R $(AMIGAOBJECTS)

AMIWINLIB: AMIWIN $(AMIWINOBJECTS) DeleteTMP
	$(MAKELIB) $(LIB_NAME) R $(AMIWINOBJECTS)

# Makes temporary scoptions to use in global .c.o	
AmigaLIB:
	@echo >$(TMP_FILE) "$(AMIGASCFLAGS) define=AMIGALIB"

AmigaLibrary:
	@echo >$(TMP_FILE) "$(LIBRARYSCFLAGS)"

AMIWIN:
	@echo >$(TMP_FILE) "$(AMIWINSCFLAGS)"

DeleteTMP:
	@delete $(TMP_FILE)

